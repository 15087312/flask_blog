<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* 固定导航栏样式 */
        .fixed-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to right, #4361ee, #4895ef);
            padding: 10px 20px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            {% if request.path.startswith('/admin') %}
            border-bottom: 3px solid #ff5722;
            {% endif %}
        }

        .admin-mode-indicator {
            position: fixed;
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff5722;
            color: white;
            padding: 2px 15px;
            border-radius: 0 0 4px 4px;
            font-size: 12px;
            z-index: 1001;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 0 20px;
        }

        .nav-link, .nav-button {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .nav-button {
            background: rgba(255,255,255,0.2);
            margin-left: 10px;
        }

        .nav-button:hover {
            background: rgba(255,255,255,0.3);
        }

    .nav-left, .nav-right {
        display: flex;
        align-items: center;
        gap: 15px;
    }

        .nav-avatar .avatar-img {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .nav-avatar .avatar-img:hover {
            transform: scale(1.1);
        }
        /* 头像图片样式 - 圆形头像 */
        .avatar-img {
            width: 40px;         /* 宽度40像素 */
            height: 40px;        /* 高度40像素 */
            border-radius: 50%;  /* 圆形边框 */
            cursor: pointer;     /* 鼠标指针变为手形 */
            transition: transform 0.3s;  /* 缩放动画效果，持续0.3秒 */
        }
        /* 头像悬停效果 - 轻微放大 */
        .avatar-img:hover {
            transform: scale(1.1); /* 放大10% */
        }
        /* 默认头像样式 - 当用户没有上传头像时显示 */
        .default-avatar {
            background-color: #555557; /* 背景颜色 */
            color: white;             /* 白色文字 */
            display: flex;            /* 弹性布局 */
            align-items: center;      /* 垂直居中 */
            justify-content: center;  /* 水平居中 */
            font-weight: bold;        /* 加粗字体 */
        }
        /* 认证按钮容器 - 登录/注册/登出按钮组 */
        .auth-buttons {
            position: fixed;     /* 固定定位 */
            top: 15px;          /* 距离顶部15像素 */
            right: 70px;        /* 距离右侧70像素，留出头像空间 */
            display: flex;      /* 弹性布局 */
            gap: 10px;          /* 按钮间距10像素 */
            z-index: 1000;      /* 确保在最上层 */
        }
        /* 认证按钮样式 - 登录/注册/登出按钮 */
        .auth-button {
            color: #666;         /* 灰色文字 */
            font-size: 14px;     /* 14像素字体大小 */
            text-decoration: none;  /* 去除下划线 */
            padding: 5px 10px;   /* 内边距 */
            border-radius: 4px;  /* 圆角边框 */
            transition: all 0.3s;  /* 所有属性变化动画，持续0.3秒 */
        }
        /* 认证按钮悬停效果 */
        .auth-button:hover {
            color: #333;         /* 悬停时文字颜色变深 */
            background-color: #f0f0f0;  /* 悬停时背景变浅灰色 */
        }
        /* 认证按钮点击效果 */
        .auth-button:active {
            transform: scale(0.95);  /* 点击时轻微缩小 */
        }
        /* 发布商品按钮容器 */
        .post-button-container {
            position: fixed;
            top: 20px;  /* 向下移动5px */
            right: 120px;  /* 在头像框左边 */
            z-index: 1000;
        }

        /* 发布商品按钮样式 */
        .post-button {
            background: linear-gradient(to right, #4361ee, #3f37c9);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .post-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: #333;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.5s ease, transform 0.5s ease;
        }

        .dark-mode-toggle:hover {
            transform: scale(1.1);
        }

        .dark-mode-toggle:active {
            transform: scale(0.9);
        }

        nav {
            transition: background 0.5s ease;
        }

        /* 夜晚模式样式 */
        body.dark-mode {
            --primary: #a0a0a0;
            --secondary: #808080;
            --accent: #c0c0c0;
            --dark: #f0f0f0;
            --light: #222222;
            --glass: rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, #222 0%, #444 100%);
            color: #f0f0f0;
        }

        body.dark-mode nav {
            background: linear-gradient(to right, #333, #555);
        }

        body.dark-mode .glass-card {
            background: var(--glass);
            border: 1px solid rgba(0, 0, 0, 0.18);
        }
        /* 导航栏占位符 */
        .nav-placeholder {
            height: 60px; /* 与导航栏高度匹配 */
            width: 100%;
        }
    </style>
</head>
<body>
    <!-- 导航栏占位符 -->
    <div class="nav-placeholder"></div>

    <!-- 修改后的导航栏 -->
    {% if request.path.startswith('/admin') %}
    <div class="admin-mode-indicator">管理员模式</div>
    {% endif %}
    <nav class="fixed-nav">
        <div class="nav-content">
            <!-- 左侧导航链接 -->
            <div class="nav-left">
                <a href="{{ url_for('index') }}" class="nav-link">首页</a>
                <a href="{{ url_for('search') }}" class="nav-link">搜索</a>
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('new_post') }}" class="nav-button">发布商品</a>
                {% endif %}
            </div>

            <!-- 右侧用户操作 -->
            <div class="nav-right">
                {% if not current_user.is_authenticated %}
                    <a href="{{ url_for('register') }}" class="nav-button">注册</a>
                {% endif %}
                {% if current_user.is_authenticated %}
                    <div class="nav-avatar" onclick="window.location.href='{{ url_for('profile') }}'">
                        <div class="avatar-img">
                            {{ current_user.username[0]|upper }}
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </nav>
    <!-- 消息提示区域 -->
    <div>
        <!-- 获取Flash消息 -->
        {% with messages = get_flashed_messages() %}
        {% if messages %}
            <!-- 消息列表 -->
            <ul>
            <!-- 遍历所有消息 -->
            {% for msg in messages %}
                <!-- 单条消息项 -->
                <li>{{ msg }}</li>
            {% endfor %}
            </ul>
        {% endif %}
        {% endwith %}
    </div>
    <!-- 内容块，子模板可以覆盖此部分 -->
    {% block content %}{% endblock %}
    <!-- 夜晚模式切换按钮 -->
    <button class="dark-mode-toggle">
        ☀️
    </button>

    <!-- 引入JavaScript文件 -->
    <script src="{{ url_for('static', filename='js/dark-mode.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>