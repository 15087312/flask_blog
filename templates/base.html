<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* 头像容器样式 - 固定在右上角 */
        .avatar-container {
            position: fixed;
            top: 10px;
            right: 20px;
            z-index: 1000;
        }
        /* 头像图片样式 - 圆形头像 */
        .avatar-img {
            width: 40px;         /* 宽度40像素 */
            height: 40px;        /* 高度40像素 */
            border-radius: 50%;  /* 圆形边框 */
            cursor: pointer;     /* 鼠标指针变为手形 */
            transition: transform 0.3s;  /* 缩放动画效果，持续0.3秒 */
        }
        /* 头像悬停效果 - 轻微放大 */
        .avatar-img:hover {
            transform: scale(1.1); /* 放大10% */
        }
        /* 默认头像样式 - 当用户没有上传头像时显示 */
        .default-avatar {
            background-color: #555557; /* 背景颜色 */
            color: white;             /* 白色文字 */
            display: flex;            /* 弹性布局 */
            align-items: center;      /* 垂直居中 */
            justify-content: center;  /* 水平居中 */
            font-weight: bold;        /* 加粗字体 */
        }
        /* 认证按钮容器 - 登录/注册/登出按钮组 */
        .auth-buttons {
            position: fixed;     /* 固定定位 */
            top: 15px;          /* 距离顶部15像素 */
            right: 70px;        /* 距离右侧70像素，留出头像空间 */
            display: flex;      /* 弹性布局 */
            gap: 10px;          /* 按钮间距10像素 */
            z-index: 1000;      /* 确保在最上层 */
        }
        /* 认证按钮样式 - 登录/注册/登出按钮 */
        .auth-button {
            color: #666;         /* 灰色文字 */
            font-size: 14px;     /* 14像素字体大小 */
            text-decoration: none;  /* 去除下划线 */
            padding: 5px 10px;   /* 内边距 */
            border-radius: 4px;  /* 圆角边框 */
            transition: all 0.3s;  /* 所有属性变化动画，持续0.3秒 */
        }
        /* 认证按钮悬停效果 */
        .auth-button:hover {
            color: #333;         /* 悬停时文字颜色变深 */
            background-color: #f0f0f0;  /* 悬停时背景变浅灰色 */
        }
        /* 认证按钮点击效果 */
        .auth-button:active {
            transform: scale(0.95);  /* 点击时轻微缩小 */
        }
        /* 发布商品按钮容器 */
        .post-button-container {
            position: fixed;
            top: 20px;  /* 向下移动5px */
            right: 120px;  /* 在头像框左边 */
            z-index: 1000;
        }

        /* 发布商品按钮样式 */
        .post-button {
            background: linear-gradient(to right, #4361ee, #3f37c9);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .post-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>
    <!-- 主导航栏 -->
    <nav>
        <!-- 首页链接 -->
        <a href="{{ url_for('index') }}">首页</a>

        <!-- 用户认证状态判断 -->
        {% if current_user.is_authenticated %}
            <!-- 已登录用户显示新建文章链接 -->
            <div class="post-button-container">
                <a href="{{ url_for('new_post') }}" class="post-button">发布商品</a>
            </div>
        {% endif %}

        <!-- 认证按钮区域 - 始终显示 -->
        <div class="auth-buttons">
            <!-- 头像容器，点击跳转到个人资料页或登录页 -->
            <div class="avatar-container" onclick="window.location.href='{{ url_for('profile') if current_user.is_authenticated else url_for('login') }}'">
                <!-- 默认头像显示 -->
                <div class="avatar-img default-avatar">
                    {{ current_user.username[0]|upper if current_user.is_authenticated else "登录" }}
                </div>
            </div>
            {% if not current_user.is_authenticated %}
                <!-- 登录按钮 -->
                <a href="{{ url_for('login') }}" class="auth-button">登录</a>
                <!-- 注册按钮 -->
                <a href="{{ url_for('register') }}" class="auth-button">注册</a>
            {% endif %}
        </div>
    </nav>
    <!-- 消息提示区域 -->
    <div>
        <!-- 获取Flash消息 -->
        {% with messages = get_flashed_messages() %}
        {% if messages %}
            <!-- 消息列表 -->
            <ul>
            <!-- 遍历所有消息 -->
            {% for msg in messages %}
                <!-- 单条消息项 -->
                <li>{{ msg }}</li>
            {% endfor %}
            </ul>
        {% endif %}
        {% endwith %}
    </div>
    <!-- 内容块，子模板可以覆盖此部分 -->
    {% block content %}{% endblock %}
</body>
</html>