{% extends "base.html" %}

{% block content %}
<div class="title-container">
    <h1 class="artistic-title">å•†å“æœç´¢</h1>
</div>

<!-- æœç´¢è¡¨å• -->
<form method="get" action="{{ url_for('search') }}" class="search-form glass-form">
    <input type="text" name="query" placeholder="æœç´¢å•†å“..." value="{{ query }}" class="search-input" autofocus>
    <button type="submit" class="search-btn">æœç´¢</button>
</form>

<!-- æœç´¢ç»“æœç»Ÿè®¡ -->
{% if query %}
<div class="search-stats">
    <p>æœç´¢ "<strong>{{ query }}</strong>" æ‰¾åˆ° <strong>{{ results|length }}</strong> ä¸ªç»“æœ</p>
</div>
{% endif %}

<!-- æœç´¢ç»“æœåˆ—è¡¨ -->
<div class="products-container">
{% if results %}
    {% for post in results %}
    <div class="product-card">
        <h2><a href="{{ url_for('view_post', post_id=post.id) }}">{{ post.title }}</a></h2>
        <p class="product-seller">å–å®¶: {{ post.author.username }}</p>
        <p class="product-price">ä»·æ ¼: Â¥{{ "%.2f"|format(post.price) }}</p>
        <p class="product-description">{{ post.body[:150] }}{% if post.body|length > 150 %}...{% endif %}</p>
        <div class="product-meta">
            <span class="product-status status-{{ post.status }}">
                {% if post.status == 'available' %}å¯è´­ä¹°
                {% elif post.status == 'reserved' %}å·²é¢„è®¢
                {% elif post.status == 'sold' %}å·²å”®å‡º
                {% else %}{{ post.status }}
                {% endif %}
            </span>
            <span class="product-views">æµè§ˆ: {{ post.views }}</span>
        </div>
        <div class="product-actions">
            <a href="{{ url_for('view_post', post_id=post.id) }}" class="view-product">æŸ¥çœ‹è¯¦æƒ…</a>
        </div>
    </div>
    {% endfor %}
{% elif query %}
    <div class="no-results">
        <p>ğŸ˜” æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å•†å“</p>
        <p class="suggestion">è¯•è¯•å…¶ä»–å…³é”®è¯å§</p>
    </div>
{% else %}
    <div class="search-hint">
        <p>ğŸ’¡ åœ¨ä¸Šæ–¹è¾“å…¥å…³é”®è¯æœç´¢å•†å“</p>
    </div>
{% endif %}
</div>

<style>
    /* æ ‡é¢˜å®¹å™¨ */
    .title-container {
        background: rgba(255,255,255,0.9);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        margin: 20px 0;
        backdrop-filter: blur(5px);
    }

    /* è‰ºæœ¯å­—æ ‡é¢˜æ ·å¼ */
    .artistic-title {
        font-family: 'Arial', sans-serif;
        background: linear-gradient(to right, #4361ee, #4895ef);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        font-size: 2.5em;
        margin: 0;
        text-align: center;
    }

    /* æœç´¢è¡¨å•æ ·å¼ */
    .search-form {
        display: flex;
        justify-content: center;
        align-items: center;
        background: none;
        border: none;
        padding: 0;
        position: relative;
        width: fit-content;
        box-shadow: none;
        margin: 30px auto;
        margin-left: auto;
        margin-right: auto;
    }

    /* é€æ˜è¡¨å•æ ·å¼ */
    .glass-form {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border-radius: 25px;
        padding: 10px 20px;
    }

    body.dark-mode .glass-form {
        background: rgba(0, 0, 0, 0.15);
    }

    /* æœç´¢è¾“å…¥æ¡†æ ·å¼ */
    .search-input {
        padding: 12px 20px;
        width: 400px;
        border: 2px solid #4361ee;
        border-radius: 25px;
        outline: none;
        font-size: 1em;
        transition: all 0.3s;
        background: white;
    }

    .glass-form .search-input {
        background: transparent;
        color: #333;
        border: 2px solid #4361ee;
    }

    .glass-form .search-input::placeholder {
        color: rgba(0, 0, 0, 0.6);
    }

    .search-input:focus {
        border-color: #3f37c9;
        box-shadow: 0 0 10px rgba(67, 97, 238, 0.3);
    }

    /* æœç´¢æŒ‰é’®æ ·å¼ */
    .search-btn {
        display: inline-block;
        padding: 10px 15px;
        background-color: #4e73df;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-left: 10px;
    }

    .search-btn:hover {
        background-color: #3f37c9;
    }

    body.dark-mode .search-btn {
        background-color: #555;
    }

    body.dark-mode .search-btn:hover {
        background-color: #666;
    }

    body.dark-mode .glass-form .search-input {
        background: transparent;
        color: #f0f0f0;
        border: 2px solid #a0a0a0;
    }

    body.dark-mode .glass-form .search-input::placeholder {
        color: rgba(255, 255, 255, 0.7);
    }

    body.dark-mode .search-input:focus {
        border-color: #c0c0c0;
        box-shadow: 0 0 8px rgba(160, 160, 160, 0.3);
    }

    /* æœç´¢ç»Ÿè®¡ */
    .search-stats {
        text-align: center;
        margin: 20px 0;
        padding: 15px;
        background: rgba(67, 97, 238, 0.1);
        border-radius: 8px;
    }

    .search-stats p {
        margin: 0;
        color: #333;
        font-size: 1.1em;
    }

    /* å•†å“åˆ—è¡¨å®¹å™¨ */
    .products-container {
        margin-top: 20px;
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
    }

    /* å•†å“å¡ç‰‡æ ·å¼ */
    .product-card {
        padding: 20px;
        border: 1px solid #eee;
        border-radius: 10px;
        margin-bottom: 20px;
        background: white;
        transition: all 0.3s ease;
    }

    .product-card:hover {
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transform: translateY(-2px);
    }

    .product-card h2 {
        margin: 0 0 10px 0;
        font-size: 1.5em;
    }

    .product-card h2 a {
        color: #2a66e4;
        text-decoration: none;
        transition: color 0.3s;
    }

    .product-card h2 a:hover {
        color: #3f37c9;
        text-decoration: underline;
    }

    /* å–å®¶ä¿¡æ¯ */
    .product-seller {
        color: #666;
        font-size: 0.9em;
        margin: 5px 0;
    }

    /* ä»·æ ¼æ ·å¼ */
    .product-price {
        color: #e74c3c;
        font-size: 1.2em;
        font-weight: bold;
        margin: 10px 0;
    }

    /* å•†å“æè¿° */
    .product-description {
        color: #333;
        line-height: 1.6;
        margin: 15px 0;
    }

    /* å•†å“å…ƒä¿¡æ¯ */
    .product-meta {
        display: flex;
        gap: 15px;
        margin: 15px 0;
        align-items: center;
    }

    /* å•†å“çŠ¶æ€ */
    .product-status {
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.85em;
        font-weight: bold;
    }

    .status-available {
        background: #d4edda;
        color: #155724;
    }

    .status-reserved {
        background: #fff3cd;
        color: #856404;
    }

    .status-sold {
        background: #f8d7da;
        color: #721c24;
    }

    .status-removed {
        background: #e2e3e5;
        color: #383d41;
    }

    /* æµè§ˆæ¬¡æ•° */
    .product-views {
        color: #666;
        font-size: 0.9em;
    }

    /* å•†å“æ“ä½œ */
    .product-actions {
        margin-top: 15px;
    }

    .view-product {
        color: #2a66e4;
        text-decoration: none;
        font-weight: bold;
        padding: 8px 20px;
        border: 2px solid #2a66e4;
        border-radius: 20px;
        display: inline-block;
        transition: all 0.3s;
    }

    .view-product:hover {
        background: #2a66e4;
        color: white;
    }

    /* æ— ç»“æœæç¤º */
    .no-results {
        text-align: center;
        padding: 60px 20px;
        background: rgba(255,255,255,0.9);
        border-radius: 10px;
        margin: 40px 0;
    }

    .no-results p {
        font-size: 1.3em;
        color: #666;
        margin: 10px 0;
    }

    .suggestion {
        font-size: 1em !important;
        color: #999 !important;
    }

    /* æœç´¢æç¤º */
    .search-hint {
        text-align: center;
        padding: 80px 20px;
        color: #999;
    }

    .search-hint p {
        font-size: 1.2em;
    }

    /* é»‘å¤œæ¨¡å¼é€‚é… */
    body.dark-mode .title-container {
        background: rgba(0,0,0,0.2);
    }

    body.dark-mode .artistic-title {
        background: linear-gradient(to right, #a0a0a0, #c0c0c0);
        -webkit-background-clip: text;
        background-clip: text;
    }

    body.dark-mode .search-input {
        background-color: #333;
        color: #f0f0f0;
        border-color: #a0a0a0;
    }

    body.dark-mode .search-input:focus {
        border-color: #c0c0c0;
        box-shadow: 0 0 10px rgba(160, 160, 160, 0.3);
    }

    body.dark-mode .glass-form .search-input {
        background: transparent;
        color: #f0f0f0;
    }

    body.dark-mode .glass-form .search-input::placeholder {
        color: rgba(255, 255, 255, 0.7);
    }

    body.dark-mode .search-btn {
        background: linear-gradient(to right, #555, #666);
    }

    body.dark-mode .search-stats {
        background: rgba(160, 160, 160, 0.1);
    }

    body.dark-mode .search-stats p {
        color: #f0f0f0;
    }

    body.dark-mode .product-card {
        background: rgba(0,0,0,0.15);
        border-color: rgba(255,255,255,0.1);
    }

    body.dark-mode .product-card h2 a {
        color: #a0a0a0;
    }

    body.dark-mode .product-card h2 a:hover {
        color: #c0c0c0;
    }

    body.dark-mode .product-description {
        color: #f0f0f0;
    }

    body.dark-mode .no-results {
        background: rgba(0,0,0,0.2);
    }

    body.dark-mode .no-results p {
        color: #f0f0f0;
    }

    body.dark-mode .suggestion {
        color: #a0a0a0 !important;
    }

    body.dark-mode .search-hint {
        color: #a0a0a0;
    }
</style>
{% endblock %}